<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>异常控制流 | Leonhardt&#39;s Blog</title>
    <meta name="generator" content="VuePress 1.8.2">
    <script src="https://cdn.jsdelivr.net/npm/react/umd/react.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/react-dom/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@babel/standalone/babel.min.js"></script>
    <link rel="alternate" type="application/atom+xml" href="https://kigane.github.io/atom.xml" title="Leonhardt&#39;s Blog Atom Feed">
    <link rel="alternate" type="application/json" href="https://kigane.github.io/feed.json" title="Leonhardt&#39;s Blog JSON Feed">
    <link rel="alternate" type="application/rss+xml" href="https://kigane.github.io/rss.xml" title="Leonhardt&#39;s Blog RSS Feed">
    <link rel="icon" href="/favicon.ico">
    <link rel="icon" href="/assets/icon/chrome-mask-512.png" type="image/png" sizes="512x512">
    <link rel="icon" href="/assets/icon/chrome-mask-192.png" type="image/png" sizes="192x192">
    <link rel="icon" href="/assets/icon/chrome-512.png" type="image/png" sizes="512x512">
    <link rel="icon" href="/assets/icon/chrome-192.png" type="image/png" sizes="192x192">
    <link rel="manifest" href="/manifest.webmanifest" crossorigin="use-credentials">
    <link rel="apple-touch-icon" href="/assets/icon/apple-icon-152.png">
    <meta name="description" content="想，都是问题。做，才是答案。">
    <meta property="og:url" content="/note/cs/ECF.html">
    <meta property="og:site_name" content="Leonhardt's Blog">
    <meta property="og:title" content="异常控制流">
    <meta property="og:description" content="异常 异常和异常处理异常(exception)：就是控制流中的突变，用来相应处理器状态中的某些变化。; 事件(event)：即状态变化。在处理器中，状态被编码为不同的位和信号。; 异常号(exception number)：系统为每种类型的异常分配的唯一的非负整数标识。; 异常表(exception table)：当处理器检测到事件发生时，会通过该表">
    <meta property="og:type" content="article">
    <meta property="og:locale" content="zh-CN">
    <meta property="og:locale:alternate" content="en-US">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image:alt" content="Leonhardt's Blog">
    <meta property="article:author" content="Leonhardt">
    <meta name="theme-color" content="#46bd87">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/assets/icon/ms-icon-144.png">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    
    <link rel="preload" href="/assets/css/0.styles.fec63dd8.css" as="style"><link rel="preload" href="/assets/js/app.2bdc4ba3.js" as="script"><link rel="preload" href="/assets/js/vendors~layout-Layout.6d9d91f8.js" as="script"><link rel="preload" href="/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound.a42f9c7b.js" as="script"><link rel="preload" href="/assets/js/page-异常控制流.f13df06b.js" as="script"><link rel="preload" href="/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound~layout-Slide.d0bef86f.js" as="script"><link rel="prefetch" href="/assets/js/76.2e9907f4.js"><link rel="prefetch" href="/assets/js/77.0f8f692c.js"><link rel="prefetch" href="/assets/js/78.4b003b6d.js"><link rel="prefetch" href="/assets/js/79.2fcd8948.js"><link rel="prefetch" href="/assets/js/layout-Blog.0fb9cc2a.js"><link rel="prefetch" href="/assets/js/layout-Layout.60f5be12.js"><link rel="prefetch" href="/assets/js/layout-NotFound.a56ee07b.js"><link rel="prefetch" href="/assets/js/layout-Slide.4c560ea5.js"><link rel="prefetch" href="/assets/js/page-Attentionisallyouneed.baa5963e.js"><link rel="prefetch" href="/assets/js/page-BOMDOMEvent.42a17791.js"><link rel="prefetch" href="/assets/js/page-BlogHome.b0c49415.js"><link rel="prefetch" href="/assets/js/page-C++小知识.ab61db13.js"><link rel="prefetch" href="/assets/js/page-CC++文件IO.c9e1b3e0.js"><link rel="prefetch" href="/assets/js/page-CSS基础.875f318d.js"><link rel="prefetch" href="/assets/js/page-CSS布局.6e36f66c.js"><link rel="prefetch" href="/assets/js/page-CSS模块化.adf5bd8c.js"><link rel="prefetch" href="/assets/js/page-CSS预处理器.ec6c1fd6.js"><link rel="prefetch" href="/assets/js/page-CSS高级话题.904d39ee.js"><link rel="prefetch" href="/assets/js/page-CustomLayout.4d0a55dd.js"><link rel="prefetch" href="/assets/js/page-C语言.49bb651f.js"><link rel="prefetch" href="/assets/js/page-EffectivePython.e274b7a6.js"><link rel="prefetch" href="/assets/js/page-Hazel.af5584f2.js"><link rel="prefetch" href="/assets/js/page-HelloVuepress.30647ccf.js"><link rel="prefetch" href="/assets/js/page-ICS-PA心得.d9bf93dd.js"><link rel="prefetch" href="/assets/js/page-IntroPage.862e0917.js"><link rel="prefetch" href="/assets/js/page-JS基础.f3a15d39.js"><link rel="prefetch" href="/assets/js/page-JS对象.48cd7566.js"><link rel="prefetch" href="/assets/js/page-JS小知识.d9882c95.js"><link rel="prefetch" href="/assets/js/page-Linux-Ubantu.c905e07b.js"><link rel="prefetch" href="/assets/js/page-Markdown增强.b432ebc3.js"><link rel="prefetch" href="/assets/js/page-OpenCV.e7ef2d0b.js"><link rel="prefetch" href="/assets/js/page-OpenGL基础.87a0cf63.js"><link rel="prefetch" href="/assets/js/page-PyQt5ImageViewer示例.057cc036.js"><link rel="prefetch" href="/assets/js/page-PyQt5的ModelView组件.76bcc9c8.js"><link rel="prefetch" href="/assets/js/page-PyQt5记录.139206e4.js"><link rel="prefetch" href="/assets/js/page-VuePress默认主题设置.5a43c2cb.js"><link rel="prefetch" href="/assets/js/page-Vuejs.8dc2671e.js"><link rel="prefetch" href="/assets/js/page-css小技巧.b0e419f2.js"><link rel="prefetch" href="/assets/js/page-eigen库.7ab2a712.js"><link rel="prefetch" href="/assets/js/page-gdb.806261b3.js"><link rel="prefetch" href="/assets/js/page-git.7d9e8090.js"><link rel="prefetch" href="/assets/js/page-i386.2e02844f.js"><link rel="prefetch" href="/assets/js/page-katex常用写法.00b16ed6.js"><link rel="prefetch" href="/assets/js/page-numpy用法.caec794c.js"><link rel="prefetch" href="/assets/js/page-python.a9989672.js"><link rel="prefetch" href="/assets/js/page-riscv.2ae55748.js"><link rel="prefetch" href="/assets/js/page-shell.d7a80a52.js"><link rel="prefetch" href="/assets/js/page-vim.05ab8ac1.js"><link rel="prefetch" href="/assets/js/page-分水岭算法.7648f429.js"><link rel="prefetch" href="/assets/js/page-名词解释.ec15b3da.js"><link rel="prefetch" href="/assets/js/page-宏.77761aa1.js"><link rel="prefetch" href="/assets/js/page-密码加密的文章.b011ebe6.js"><link rel="prefetch" href="/assets/js/page-导言.c3fe641f.js"><link rel="prefetch" href="/assets/js/page-帧缓冲(FrameBuffer).04229970.js"><link rel="prefetch" href="/assets/js/page-我的博客.50351d2e.js"><link rel="prefetch" href="/assets/js/page-数字图像处理.b714481c.js"><link rel="prefetch" href="/assets/js/page-正则表达式.a8cbed57.js"><link rel="prefetch" href="/assets/js/page-游戏引擎总览.d89a6f58.js"><link rel="prefetch" href="/assets/js/page-直方图均衡化.e2d7060a.js"><link rel="prefetch" href="/assets/js/page-算法.644c71dd.js"><link rel="prefetch" href="/assets/js/page-组件禁用.7cf26010.js"><link rel="prefetch" href="/assets/js/page-编译器相关.84111f7e.js"><link rel="prefetch" href="/assets/js/page-虚拟内存.9ee58237.js"><link rel="prefetch" href="/assets/js/page-计算机概述.31109813.js"><link rel="prefetch" href="/assets/js/page-论文十问.ebb0d06e.js"><link rel="prefetch" href="/assets/js/page-资源与工具.a83b2f73.js"><link rel="prefetch" href="/assets/js/page-软件渲染器.496def59.js"><link rel="prefetch" href="/assets/js/page-这主题废弃了标题？.04f1da66.js"><link rel="prefetch" href="/assets/js/page-随机数.c8af81c5.js"><link rel="prefetch" href="/assets/js/page-页面配置.a1f657e0.js"><link rel="prefetch" href="/assets/js/vendors~flowchart.bd023134.js"><link rel="prefetch" href="/assets/js/vendors~mermaid.d6f630f5.js"><link rel="prefetch" href="/assets/js/vendors~photo-swipe.308088a1.js"><link rel="prefetch" href="/assets/js/vendors~reveal.76234f09.js">
    <link rel="stylesheet" href="/assets/css/0.styles.fec63dd8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container has-navbar has-sidebar has-anchor"><header class="navbar"><!----> <div class="content__navbar-start"></div> <button title="Sidebar Button" class="sidebar-button"><span class="icon"></span></button> <a href="/" class="home-link router-link-active"><img src="/link.png" alt="Leonhardt's Blog" class="logo"> <!----> <span class="site-name can-hide">Leonhardt's Blog</span></a> <!----> <div class="content__navbar-center"></div> <div class="links"><button tabindex="-1" aria-hidden="true" class="color-button"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="skin-icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4
        38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32
        51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0
        102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2
        6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4
        0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2
        9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224
        419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4
        470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0
        22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6
        12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128
        505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2
        16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8
        86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4
        80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6
        6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg> <div class="color-picker-menu" style="display:none;"><div class="theme-options"><ul class="themecolor-select"><label for="themecolor-select">Theme Color:</label> <li><span class="default-theme"></span></li> </ul> <div class="darkmode-toggle"><label for="darkmode-toggle" class="desc">Theme Mode:</label> <div class="darkmode-switch"><div class="item day"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon light-icon"><path d="M512 256a42.667 42.667 0 0 0 42.667-42.667V128a42.667 42.667 0 0 0-85.334 0v85.333A42.667 42.667 0 0 0 512 256zm384 213.333h-85.333a42.667 42.667 0 0 0 0 85.334H896a42.667 42.667 0 0 0 0-85.334zM256 512a42.667 42.667 0 0 0-42.667-42.667H128a42.667 42.667 0 0 0 0 85.334h85.333A42.667 42.667 0 0 0 256 512zm9.387-298.667a42.667 42.667 0 0 0-59.307 62.72l61.44 59.307a42.667 42.667 0 0 0 31.147 11.947 42.667 42.667 0 0 0 30.72-13.227 42.667 42.667 0 0 0 0-60.16zm459.946 133.974a42.667 42.667 0 0 0 29.44-11.947l61.44-59.307a42.667 42.667 0 0 0-57.6-62.72l-61.44 60.587a42.667 42.667 0 0 0 0 60.16 42.667 42.667 0 0 0 28.16 13.227zM512 768a42.667 42.667 0 0 0-42.667 42.667V896a42.667 42.667 0 0 0 85.334 0v-85.333A42.667 42.667 0 0 0 512 768zm244.48-79.36a42.667 42.667 0 0 0-59.307 61.44l61.44 60.587a42.667 42.667 0 0 0 29.44 11.946 42.667 42.667 0 0 0 30.72-12.8 42.667 42.667 0 0 0 0-60.586zm-488.96 0-61.44 59.307a42.667 42.667 0 0 0 0 60.586 42.667 42.667 0 0 0 30.72 12.8 42.667 42.667 0 0 0 28.587-10.666l61.44-59.307a42.667 42.667 0 0 0-59.307-61.44zM512 341.333A170.667 170.667 0 1 0 682.667 512 170.667 170.667 0 0 0 512 341.333z" fill="currentColor"></path></svg></div> <div class="item auto active"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon auto-icon"><path d="M460.864 539.072H564.8L510.592 376l-49.728 163.072zM872 362.368V149.504H659.648L510.528 0l-149.12 149.504H149.12v212.928L0 511.872l149.12 149.504v212.928h212.352l149.12 149.504 149.12-149.504h212.352V661.376l149.12-149.504L872 362.368zM614.464 693.12l-31.616-90.624H438.272l-31.616 90.624h-85.888l144.576-407.68h90.368l144.576 407.68h-85.824zm0 0" fill="currentColor"></path></svg></div> <div class="item night"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon dark-icon"><path d="M935.539 630.402c-11.43-11.432-28.674-14.739-43.531-8.354-46.734 20.103-96.363 30.297-147.508 30.297-99.59 0-193.221-38.784-263.64-109.203-108.637-108.637-139.61-270.022-78.908-411.148a39.497 39.497 0 0 0-51.886-51.887c-52.637 22.64-100.017 54.81-140.826 95.616-85.346 85.346-132.346 198.821-132.346 319.52 0 120.7 47.001 234.172 132.347 319.519S408.063 947.11 528.76 947.11c120.7 0 234.172-47.003 319.52-132.351 40.809-40.81 72.978-88.19 95.616-140.826a39.497 39.497 0 0 0-8.356-43.532z" fill="currentColor"></path></svg></div></div> <!----></div></div></div></button> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link router-link-active"><i class="iconfont icon-home"></i>
  Home
</a></div><div class="nav-item"><a href="/home/" class="nav-link"><i class="iconfont icon-notice"></i>
  Target
</a></div><div class="nav-item"><a href="/guide/" class="nav-link"><i class="iconfont icon-creative"></i>
  Guide
</a></div><div class="nav-item"><a href="/blog/" class="nav-link"><i class="iconfont icon-blog"></i>
  Blog
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Note" class="dropdown-title"><span class="title"><i class="iconfont icon-note"></i>
        Note
      </span> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><a href="/note/algorithm/" class="nav-link"><!---->
  Algorithm
</a></li><li class="dropdown-item"><a href="/note/cs/" class="nav-link router-link-active active"><!---->
  Computer Science
</a></li><li class="dropdown-item"><a href="/note/cv/" class="nav-link"><!---->
  Computer Vision
</a></li><li class="dropdown-item"><a href="/note/cpp/" class="nav-link"><!---->
  C/C++
</a></li><li class="dropdown-item"><a href="/note/opengl/" class="nav-link"><!---->
  OpenGL
</a></li><li class="dropdown-item"><a href="/note/js/" class="nav-link"><!---->
  JavaScript
</a></li></ul></div></div><div class="nav-item"><a href="/thesis/" class="nav-link"><i class="iconfont icon-article"></i>
  Thesis
</a></div></nav> <!----> <a rel="noopener noreferrer" href="https://github.com/kigane/HopeBlog" target="_blank" class="repo-link can-hide">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <!----> <div class="content__navbar-end"></div></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><div vocab="https://schema.org/" typeof="Person" class="blogger-info mobile"><div data-balloon-pos="down" role="navigation" class="blogger hasIntro"><img property="image" alt="Blogger Avatar" src="/link.png" class="avatar round"> <div property="name" class="name">Leonhardt</div> <meta property="url" content="/intro/"></div> <div class="num-wrapper"><div><div class="num">62</div> <div>Articles</div></div> <div><div class="num">7</div> <div>Category</div></div> <div><div class="num">14</div> <div>Tags</div></div> <div><div class="num">62</div> <div>Timeline</div></div></div> <div class="media-links-wrapper"><a href="https://zhihu.com" rel="noopener noreferrer" target="_blank" aria-label="Zhihu" data-balloon-pos="up" class="media-link"><span class="sr-only">Zhihu</span> <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon icon-zhihu"><circle cx="512" cy="512" r="512" fill="#006CE2"></circle> <path d="M513.65 491.261H411.551c1.615-16.154 5.815-60.095 5.815-84.973 0-24.88-.323-60.742-.323-60.742h102.744V329.39c0-21.647-9.37-31.34-17.124-31.34h-178.67s5.169-17.77 10.015-36.186c4.846-18.417 15.832-44.264 15.832-44.264-63.003 4.2-67.958 50.941-81.743 92.729-13.787 41.785-24.556 62.356-44.586 107.912 27.786 0 55.249-13.57 66.879-32.309 11.631-18.74 16.908-40.71 16.908-40.71h62.035v59.019c0 21.107-3.878 87.45-3.878 87.45H254.742c-19.386 0-29.724 48.894-29.724 48.894h133.76c-8.4 75.82-26.493 106.191-51.91 152.716-25.418 46.525-92.728 99.406-92.728 99.406 41.033 11.63 86.589-3.555 105.974-21.972 19.386-18.417 35.863-49.756 47.817-72.838 11.954-23.081 21.972-65.124 21.972-65.124L498.462 766.86s4.846-24.233 6.461-39.418c1.616-15.186-.755-26.385-4.63-35.433-3.878-9.046-15.509-21.54-31.018-39.634-15.507-18.094-48.034-52.879-48.034-52.879s-15.832 11.63-28.108 21.001c9.046-21.97 16.262-79.695 16.262-79.695h122.343v-20.249c.003-17.66-7.319-29.29-18.089-29.29zm287.337-200.747h-234.35a4.308 4.308 0 0 0-4.309 4.308v435.099a4.308 4.308 0 0 0 4.308 4.308h40.226l14.7 50.402 81.096-50.402h98.328a4.308 4.308 0 0 0 4.308-4.308v-435.1a4.308 4.308 0 0 0-4.308-4.308zM755.97 684.47h-52.343l-61.548 39.095-10.823-39.095h-18.738V338.116H755.97v346.355z" fill="#FFF"></path></svg></a><a href="https://baidu.com" rel="noopener noreferrer" target="_blank" aria-label="Baidu" data-balloon-pos="up" class="media-link"><span class="sr-only">Baidu</span> <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon icon-baidu"><circle cx="512" cy="512" r="512" fill="#1D2FE3"></circle> <path d="M239.022 704.978c.098-4.865-.314-9.772.162-14.591 5.178-52.464 197.571-253.377 249.641-259.233 42.996-4.833 75.768 16.545 99.824 49.144 37.893 51.351 82.81 95.455 131.292 136.237 52.903 44.503 56.525 99.801 32.6 158.592-23.425 57.56-75.34 69.833-127.771 58.804-84.971-17.874-168.158-13.744-253.37-4.536-86.35 9.333-133.788-39.4-132.378-124.417zM352.464 412.86c-3.58 50.707-17.93 96.128-75.9 98.12-58.053 1.995-80.093-41.432-79.275-91.71.81-49.705 13.416-104.053 76.851-102.136 53.84 1.625 74.74 45.8 78.324 95.726zm386.053 142.168c-68.494-1.735-84.188-43.331-82.635-93.812 1.46-47.519 10.082-97.628 73.299-96.65 61.395.95 81.6 43.207 81.553 98.668-.047 53.156-19.818 89.398-72.217 91.794zm-45.235-278.345c-10.464 42.665-24.513 91.761-85.919 94.502-52.74 2.354-71.705-34.482-72.805-81.242-1.233-52.42 48.08-112.965 87.582-110.373 33.943 2.226 71.146 49.541 71.142 97.113zm-195.147-14.097c-7.005 46.274-13.63 100.025-71.562 101.351-57.077 1.306-73.567-47.922-73.638-97.109-.068-48.054 12.128-99.024 69.345-101.426 59.45-2.493 67.11 51.093 75.855 97.184z" fill="#fff"></path> <path d="M479.52 663.165c.006 12.194 1.498 24.61-.284 36.537-4.707 31.503 18.862 78.749-45.326 77.534-54.226-1.027-103.338-3.31-113.231-73.536-7.164-50.852 7.78-85.674 57.687-102.668 17.67-6.016 39.618 5.058 54.096-14.548 10.84-14.679-2.901-54.592 33.418-41.47 24.075 8.7 11.477 38.922 13.278 59.652 1.68 19.366.359 38.99.363 58.5zm175.45 41.902c4.291 39.657 5.093 78.047-64.709 73.503-60.097-3.912-95.56-20.794-86.293-85.624 4.287-29.991-21.148-83.238 22.19-84.867 42.71-1.606 13.57 50.41 20.825 77.622 5.276 19.794-3.984 46.774 29.753 48.193 41.337 1.738 28.383-30.022 31.099-51.604 1.209-9.61-.85-19.65.528-29.215 2.516-17.474-8.928-44.716 19.554-47.191 36.044-3.133 24.155 28.376 26.678 47.523 1.896 14.387.375 29.225.375 51.66z" fill="#1D2FE3"></path> <path d="M435.669 685.038c-2.255 24.07 5.605 53.68-33.623 52.136-34.594-1.362-35.274-31.818-38.513-53.078-4.028-26.448 11.38-48.18 40.785-50.023 40.967-2.564 27.097 30.764 31.35 50.965z" fill="#fff"></path></svg></a><a href="https://github.com" rel="noopener noreferrer" target="_blank" aria-label="Github" data-balloon-pos="up" class="media-link"><span class="sr-only">Github</span> <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon icon-github"><circle cx="512" cy="512" r="512" fill="#171515"></circle> <path d="M509.423 146.442c-200.317 0-362.756 162.42-362.756 362.8 0 160.266 103.936 296.24 248.109 344.217 18.139 3.327 24.76-7.872 24.76-17.486 0-8.613-.313-31.427-.49-61.702-100.912 21.923-122.205-48.63-122.205-48.63-16.495-41.91-40.28-53.067-40.28-53.067-32.937-22.51 2.492-22.053 2.492-22.053 36.407 2.566 55.568 37.386 55.568 37.386 32.362 55.438 84.907 39.43 105.58 30.143 3.296-23.444 12.667-39.43 23.032-48.498-80.557-9.156-165.246-40.28-165.246-179.297 0-39.604 14.135-71.988 37.342-97.348-3.731-9.178-16.18-46.063 3.556-96.009 0 0 30.46-9.754 99.76 37.19 28.937-8.048 59.97-12.071 90.823-12.211 30.807.14 61.843 4.165 90.822 12.21 69.26-46.944 99.663-37.189 99.663-37.189 19.792 49.946 7.34 86.831 3.61 96.01 23.25 25.359 37.29 57.742 37.29 97.347 0 139.366-84.82 170.033-165.637 179.013 13.026 11.2 24.628 33.342 24.628 67.182 0 48.498-.445 87.627-.445 99.521 0 9.702 6.535 20.988 24.945 17.444 144.03-48.067 247.881-183.95 247.881-344.175 0-200.378-162.442-362.798-362.802-362.798z" fill="#FFF"></path></svg></a></div></div> <hr> <!----> <div class="content__sidebar-top"></div> <nav class="sidebar-nav-links"><div class="nav-item"><a href="/" class="nav-link router-link-active"><i class="iconfont icon-home"></i>
  Home
</a></div><div class="nav-item"><a href="/home/" class="nav-link"><i class="iconfont icon-notice"></i>
  Target
</a></div><div class="nav-item"><a href="/guide/" class="nav-link"><i class="iconfont icon-creative"></i>
  Guide
</a></div><div class="nav-item"><a href="/blog/" class="nav-link"><i class="iconfont icon-blog"></i>
  Blog
</a></div><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="Note" class="dropdown-title"><span class="title"><i class="iconfont icon-note"></i>
      Note
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note/algorithm/" class="nav-link"><!---->
  Algorithm
</a></li><li class="dropdown-item"><!----> <a href="/note/cs/" class="nav-link router-link-active active"><!---->
  Computer Science
</a></li><li class="dropdown-item"><!----> <a href="/note/cv/" class="nav-link"><!---->
  Computer Vision
</a></li><li class="dropdown-item"><!----> <a href="/note/cpp/" class="nav-link"><!---->
  C/C++
</a></li><li class="dropdown-item"><!----> <a href="/note/opengl/" class="nav-link"><!---->
  OpenGL
</a></li><li class="dropdown-item"><!----> <a href="/note/js/" class="nav-link"><!---->
  JavaScript
</a></li></ul></div></div><div class="nav-item"><a href="/thesis/" class="nav-link"><i class="iconfont icon-article"></i>
  Thesis
</a></div> <a rel="noopener noreferrer" href="https://github.com/kigane/HopeBlog" target="_blank" class="repo-link">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav> <!----> <div class="content__sidebar-center"></div> <ul class="sidebar-links"><li><a href="/note/cs/" aria-current="page" class="sidebar-link">计算机概述</a></li><li><a href="/note/cs/isa-i386/" class="sidebar-link">i386</a></li><li><a href="/note/cs/isa-riscv/" class="sidebar-link">riscv</a></li><li><a href="/note/cs/gdb-cheatsheet/" class="sidebar-link">gdb</a></li><li><a href="/note/cs/shell-cheatsheet/" class="sidebar-link">shell</a></li><li><a href="/note/cs/vim/" class="sidebar-link">vim</a></li><li><a href="/note/cs/git/" class="sidebar-link">git</a></li><li><a href="/note/cs/regex/" class="sidebar-link">正则表达式</a></li><li><a href="/note/cs/linux/" class="sidebar-link">Linux - Ubantu</a></li><li><a href="/note/cs/ECF/" aria-current="page" class="active sidebar-link">异常控制流</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/cs/ECF/#异常" class="sidebar-link">异常</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/cs/ECF/#异常和异常处理" class="sidebar-link heading3">异常和异常处理</a></li><li class="sidebar-sub-header"><a href="/note/cs/ECF/#异常的类别" class="sidebar-link heading3">异常的类别</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/cs/ECF/#进程" class="sidebar-link">进程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/cs/ECF/#逻辑控制流" class="sidebar-link heading3">逻辑控制流</a></li><li class="sidebar-sub-header"><a href="/note/cs/ECF/#并发" class="sidebar-link heading3">并发</a></li><li class="sidebar-sub-header"><a href="/note/cs/ECF/#私有地址空间" class="sidebar-link heading3">私有地址空间</a></li><li class="sidebar-sub-header"><a href="/note/cs/ECF/#用户模式和内核模式" class="sidebar-link heading3">用户模式和内核模式</a></li><li class="sidebar-sub-header"><a href="/note/cs/ECF/#上下文切换" class="sidebar-link heading3">上下文切换</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/cs/ECF/#系统调用错误处理" class="sidebar-link">系统调用错误处理</a></li><li class="sidebar-sub-header"><a href="/note/cs/ECF/#进程控制" class="sidebar-link">进程控制</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/cs/ECF/#fork" class="sidebar-link heading3">fork()</a></li><li class="sidebar-sub-header"><a href="/note/cs/ECF/#waitpid-回收子进程" class="sidebar-link heading3">waitpid()--回收子进程</a></li><li class="sidebar-sub-header"><a href="/note/cs/ECF/#execve函数" class="sidebar-link heading3">execve函数</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/cs/ECF/#信号" class="sidebar-link">信号</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/cs/ECF/#信号术语" class="sidebar-link heading3">信号术语</a></li><li class="sidebar-sub-header"><a href="/note/cs/ECF/#发送信号" class="sidebar-link heading3">发送信号</a></li><li class="sidebar-sub-header"><a href="/note/cs/ECF/#接收信号" class="sidebar-link heading3">接收信号</a></li><li class="sidebar-sub-header"><a href="/note/cs/ECF/#信号的阻塞和解除" class="sidebar-link heading3">信号的阻塞和解除</a></li><li class="sidebar-sub-header"><a href="/note/cs/ECF/#编写信号处理程序" class="sidebar-link heading3">编写信号处理程序</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/cs/ECF/#非本地跳转" class="sidebar-link">非本地跳转</a></li><li class="sidebar-sub-header"><a href="/note/cs/ECF/#操作进程的工具" class="sidebar-link">操作进程的工具</a></li></ul></li><li><a href="/note/cs/VM/" class="sidebar-link">虚拟内存</a></li></ul> <!----> <div class="content__sidebar-bottom"></div> <!----></aside> <main class="page"><nav class="breadcrumb"><ol vocab="https://schema.org/" typeof="BreadcrumbList"><li property="itemListElement" typeof="ListItem"><a href="/note/cs/" property="item" typeof="WebPage" class="router-link-active"><!----> <span property="name">计算机概述</span></a> <meta property="position" content="1"></li><li property="itemListElement" typeof="ListItem" class="is-active"><a href="/note/cs/ECF/" aria-current="page" property="item" typeof="WebPage" class="router-link-exact-active router-link-active"><!----> <span property="name">异常控制流</span></a> <meta property="position" content="2"></li></ol></nav> <!----> <div class="content__page-top"></div> <div vocab="https://schema.org/" typeof="Article" class="page-title"><h1><!----> <span property="headline">异常控制流</span></h1> <div class="page-info"><!----> <!----><!----><span aria-label="Writing Date📅" data-balloon-pos="down" class="time-info"><svg viewBox="0 0 1030 1024" xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 0 1-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 0 1-33.473-33.473V143.657H180.6A134.314 134.314 0 0 0 46.66 277.595v535.756A134.314 134.314 0 0 0 180.6 947.289h669.74a134.36 134.36 0 0 0 133.94-133.938V277.595a134.314 134.314 0 0 0-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 0 1-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 0 1-33.472 33.473z" fill="currentColor"></path></svg> <span property="datePublished">2021-10-3</span></span><!----><!----><span aria-label="Reading Time⌛" data-balloon-pos="down" class="reading-time-info"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon timer-icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z" fill="currentColor"></path></svg> <span>About 19 min</span> <meta property="timeRequired" content="PT19M"></span></div> <!----> <hr></div> <div class="anchor-place-holder"><aside id="anchor"><div class="anchor-wrapper"><ul class="anchor-list"><li class="anchor"><a href="/note/cs/ECF/#异常" class="anchor-link heading2"><div>异常</div></a></li><li class="anchor"><a href="/note/cs/ECF/#异常和异常处理" class="anchor-link heading3"><div>异常和异常处理</div></a></li><li class="anchor"><a href="/note/cs/ECF/#异常的类别" class="anchor-link heading3"><div>异常的类别</div></a></li><li class="anchor"><a href="/note/cs/ECF/#进程" class="anchor-link heading2"><div>进程</div></a></li><li class="anchor"><a href="/note/cs/ECF/#逻辑控制流" class="anchor-link heading3"><div>逻辑控制流</div></a></li><li class="anchor"><a href="/note/cs/ECF/#并发" class="anchor-link heading3"><div>并发</div></a></li><li class="anchor"><a href="/note/cs/ECF/#私有地址空间" class="anchor-link heading3"><div>私有地址空间</div></a></li><li class="anchor"><a href="/note/cs/ECF/#用户模式和内核模式" class="anchor-link heading3"><div>用户模式和内核模式</div></a></li><li class="anchor"><a href="/note/cs/ECF/#上下文切换" class="anchor-link heading3"><div>上下文切换</div></a></li><li class="anchor"><a href="/note/cs/ECF/#系统调用错误处理" class="anchor-link heading2"><div>系统调用错误处理</div></a></li><li class="anchor"><a href="/note/cs/ECF/#进程控制" class="anchor-link heading2"><div>进程控制</div></a></li><li class="anchor"><a href="/note/cs/ECF/#fork" class="anchor-link heading3"><div>fork()</div></a></li><li class="anchor"><a href="/note/cs/ECF/#waitpid-回收子进程" class="anchor-link heading3"><div>waitpid()--回收子进程</div></a></li><li class="anchor"><a href="/note/cs/ECF/#execve函数" class="anchor-link heading3"><div>execve函数</div></a></li><li class="anchor"><a href="/note/cs/ECF/#信号" class="anchor-link heading2"><div>信号</div></a></li><li class="anchor"><a href="/note/cs/ECF/#信号术语" class="anchor-link heading3"><div>信号术语</div></a></li><li class="anchor"><a href="/note/cs/ECF/#发送信号" class="anchor-link heading3"><div>发送信号</div></a></li><li class="anchor"><a href="/note/cs/ECF/#接收信号" class="anchor-link heading3"><div>接收信号</div></a></li><li class="anchor"><a href="/note/cs/ECF/#信号的阻塞和解除" class="anchor-link heading3"><div>信号的阻塞和解除</div></a></li><li class="anchor"><a href="/note/cs/ECF/#编写信号处理程序" class="anchor-link heading3"><div>编写信号处理程序</div></a></li><li class="anchor"><a href="/note/cs/ECF/#非本地跳转" class="anchor-link heading2"><div>非本地跳转</div></a></li><li class="anchor"><a href="/note/cs/ECF/#操作进程的工具" class="anchor-link heading2"><div>操作进程的工具</div></a></li></ul></div></aside></div> <!----> <div class="content__content-top"></div> <div class="theme-default-content content__default"><h2 id="异常"><a href="#异常" class="header-anchor">#</a> 异常</h2> <h3 id="异常和异常处理"><a href="#异常和异常处理" class="header-anchor">#</a> 异常和异常处理</h3> <ul><li>异常(exception)：就是控制流中的突变，用来相应处理器状态中的某些变化。</li> <li>事件(event)：即状态变化。在处理器中，状态被编码为不同的位和信号。</li> <li>异常号(exception number)：系统为每种类型的异常分配的唯一的非负整数标识。</li> <li>异常表(exception table)：当处理器检测到事件发生时，会通过该表调用相应的异常处理程序。其起始地址位于一个特殊的CPU寄存器--异常表基址寄存器。在系统启动时，由操作系统分配和初始化。</li> <li>在异常处理程序完成后，根据事件的类型，处理程序的处理方式不同。</li></ul> <h3 id="异常的类别"><a href="#异常的类别" class="header-anchor">#</a> 异常的类别</h3> <ul><li>中断(interrupt):是由硬件造成的，即来自处理器外部的I/O设备的信号的结果。因此，是异步的。从中断返回时，总是返回到下一条指令。(过程：执行<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mrow><mi>c</mi><mi>u</mi><mi>r</mi><mi>r</mi></mrow></msub></mrow><annotation encoding="application/x-tex">I_{curr}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">rr</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，发生中断，执行完<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mrow><mi>c</mi><mi>u</mi><mi>r</mi><mi>r</mi></mrow></msub></mrow><annotation encoding="application/x-tex">I_{curr}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">rr</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，调用中断处理程序，处理程序返回到下一条指令<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mrow><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">I_{next}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>)</li> <li>陷阱(trap)：是有意的异常。用于为用户程序和内核之间提供系统调用，让用户程序可以向内核请求服务。具体而言，用户执行<code>syscall n</code>指令，会触发一个trap，trap的处理程序解析参数，并调用适当的内核程序。另外：系统调用运行与内核模式。</li> <li>故障(fault)：由可能能被错误处理程序修正的错误引起。如果故障处理程序能修正(如缺页异常)，则返回<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mrow><mi>c</mi><mi>u</mi><mi>r</mi><mi>r</mi></mrow></msub></mrow><annotation encoding="application/x-tex">I_{curr}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">rr</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>并重新执行这个引起异常的指令，如果无法修正(如除零，段错误)，则调用内核的abort例程，终止该程序。</li> <li>终止(abort)：由不可恢复的致命错误引起，通常是硬件错误。调用内核的abort例程，终止该程序。</li></ul> <details class="custom-block details"><summary>Linux异常和系统调用</summary> <ul><li>除法错误(0)：除零或除法溢出时发生。Unix不会从除法错误中恢复，而是会终止程序。Linux shell会报告&quot;Floating exception&quot;。</li> <li>一般保护故障(13)：原因很多，通常是因为程序引用的未定义的虚拟内存区域或试图写一个只读的文本段。Linux不会恢复这类故障，会终止程序并报告&quot;Segmentation fault&quot;。</li> <li>缺页异常：//TODO</li></ul> <p>系统调用:syscall</p> <ul><li>系统调用时，%rax保存系统调用号，%rdi,%rsi,%rdx,%r10,%r8,%r9顺序包含最多6个参数。系统调用返回时，%rcx,%r11会被破坏，%rax包含返回值。返回值为负(-4095~-1)，说明发生了错误，会设置相应的errno。</li> <li>常用系统调用
<ul><li>0 read 读文件</li> <li>1 write 写文件</li> <li>2 open 打开文件</li> <li>3 close 关闭文件</li> <li>4 stat 获取文件信息</li> <li>9 mmap 将内存页映射到文件</li> <li>12 brk 重置堆顶</li> <li>32 dup2 复制文件描述符</li> <li>33 pause 挂起进程，直到有信号到达</li> <li>37 alarm 设置定时器，时间到了发送一个alarm信号给进程，默认行为会终止进程</li> <li>39 getpid 获取进程ID</li> <li>57 fork 创建进程</li> <li>59 execve 执行一个程序</li> <li>60 _exit 终止进程</li> <li>61 wait4 等待一个进程终止</li> <li>62 kill 向一个进程发送一个信号</li></ul></li></ul></details> <h2 id="进程"><a href="#进程" class="header-anchor">#</a> 进程</h2> <ul><li>经典定义：一个执行中的程序的实例。</li> <li>上下文(context)：程序正确运行所需的状态。包括内存中程序的的代码和数据，栈，GPRs，PC，环境变量以及打开的文件描述符的集合。</li> <li>进程为应用程序提供的关键抽象：
<ul><li>一个独立的逻辑控制流</li> <li>一个私有的地址空间</li></ul></li></ul> <h3 id="逻辑控制流"><a href="#逻辑控制流" class="header-anchor">#</a> 逻辑控制流</h3> <p>即执行程序的PC值的序列。
<img src="/assets/img/csapp-ecf-01.png" alt="ECF01"><br>
关键点：进程是轮流使用处理器的，每个进程执行其流的一部分，然后被preempted(暂时挂起)，然后轮到其他进程。</p> <h3 id="并发"><a href="#并发" class="header-anchor">#</a> 并发</h3> <ul><li>一个逻辑流的执行在<strong>时间上</strong>与另一个流重叠，称为并发流(concurrent flow)，这两个流被称为并发的执行。</li> <li>并发(concurrency)：多个流并发的执行。</li> <li>多任务(multitask)：一个进程和其他进程轮流运行。</li> <li>时间片(time slice)：一个进程执行其逻辑控制流的一部分的每一时间段。</li> <li>并行流(parallel flow)：两个流并发地运行在不同的处理器或计算机上。并行流是并发流的真子集。</li></ul> <h3 id="私有地址空间"><a href="#私有地址空间" class="header-anchor">#</a> 私有地址空间</h3> <p><img src="/assets/img/csapp-ecf-02.png" alt="ECF02"><br>
进程为每个程序提供私有地址空间。通用结构如图。</p> <h3 id="用户模式和内核模式"><a href="#用户模式和内核模式" class="header-anchor">#</a> 用户模式和内核模式</h3> <p>用户模式是处理器提供的一种机制，限制应用可以执行的指令和可访问的地址空间范围，即不能使用特权指令和访问地址空间中的内核区。处理器通过某状态寄存器中的一个模式位(mode bit)确定进程处于用户模式还是内核模式。</p> <ul><li>特权指令(privileged instruction)：如停止处理器，改变模式位，发起I/O操作。</li> <li>用户只能通过系统调用接口间接访问内核的代码和数据。任何直接访问的尝试都会导致abort。</li> <li>进程从用户模式切换到内核模式的唯一方式是使用interrupt,fault,trap的异常处理程序。异常发生时，会调用异常处理程序，异常处理程序运行于内核模式中。异常处理程序返回后，就切换回用户模式。</li> <li>Linux中
<ul><li>/proc文件系统提供许多用户可以访问的内核数据结构。如/proc/cpuinfo,/proc/:pid/maps(进程使用的内存段)</li> <li>/sys文件系统提供关于系统总线和设备的低层信息。</li></ul></li></ul> <h3 id="上下文切换"><a href="#上下文切换" class="header-anchor">#</a> 上下文切换</h3> <ul><li>进程上下文
<ul><li>用户级上下文：程序块，数据块，用户堆栈</li> <li>系统级上下文：
<ul><li>进程标识信息 pid</li> <li>进程现场信息：寄存器内容(GPRs，浮点寄存器，某些状态寄存器)</li> <li>进程控制信息：PC，某些状态寄存器</li> <li>内核：内核栈和内核数据结构，包括页表，进程表，文件表。</li></ul></li></ul></li> <li>上下文切换
<ul><li>保存当前进程上下文</li> <li>恢复被切换到的进程的上下文</li> <li>将控制转移给新进程</li></ul></li> <li>上下文切换时机
<ul><li>内核执行系统调用时。系统调用发起I/O请求，或使用sleep系统调用等等。</li> <li>系统周期性中断。所有系统都有某种产生周期性定时器中断的机制，通常为1或10ms。每次发生定时器中断，内核就能判定出当前进程已经运行了足够长的时间，并切换到另一个进程。</li></ul></li></ul> <h2 id="系统调用错误处理"><a href="#系统调用错误处理" class="header-anchor">#</a> 系统调用错误处理</h2> <p>Unix系统级函数出错时，会返回-1，并设置全局整数变量errno来表示什么出错了。<code>strerrno(errno)</code>返回错误的具体描述。</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">void</span> <span class="token function">unix_error</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">&quot;%s, %s\n&quot;</span><span class="token punctuation">,</span> msg<span class="token punctuation">,</span> <span class="token function">strerr</span><span class="token punctuation">(</span>errno<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// fork 的错误包装函数</span>
<span class="token class-name">pid_t</span> <span class="token function">Fork</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">pid_t</span> pid<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>pid <span class="token operator">=</span> <span class="token function">fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token function">unix_error</span><span class="token punctuation">(</span><span class="token string">&quot;Fork error&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> pid<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="进程控制"><a href="#进程控制" class="header-anchor">#</a> 进程控制</h2> <ul><li>每个进程都有一个唯一的正整数进程 ID(PID)。</li> <li>每个进程都只属于一个进程组，进程组也是用一个正整数 ID 来标识的。默认的，子进程和父进程同属于一个进程组。</li> <li>进程的三种状态
<ul><li>运行：进程正在 CPU 上执行，或在等待被执行且最终会被调度。</li> <li>停止：进程被挂起(suspended)，不会被调度。
<ul><li>会导致停止的信号：SIGSTOP, SIGTSTP, SIGTTIN, SIGTTOU</li> <li>进程再次运行信号：SIGCONT</li></ul></li> <li>终止：进程永远停止。进程终止有三种原因
<ul><li>收到一个默认行为是终止进程的信号</li> <li>从主程序返回</li> <li>调用exit()函数</li></ul></li></ul></li></ul> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/types.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h&gt;</span></span>
<span class="token class-name">pid_t</span> <span class="token function">getpid</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 返回调用进程的PID</span>
<span class="token class-name">pid_t</span> <span class="token function">getppid</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 返回调用进程的父进程的PID</span>
<span class="token class-name">pid_t</span> <span class="token function">getpgrp</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 返回调用进程的进程组ID</span>
<span class="token keyword">int</span> <span class="token function">setpgid</span><span class="token punctuation">(</span><span class="token class-name">pid_t</span> pid<span class="token punctuation">,</span> <span class="token class-name">pid_t</span> pgid<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将pid进程的进程组改为pgid。成功返回0，否则返回-1。</span>
<span class="token comment">// setpgid(0,0)表示用当前进程的pid为名创建进程组，并将当前进程加入该进程组。</span>
<span class="token class-name">pid_t</span> <span class="token function">fork</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 创建子进程，子进程返回0，父进程返回子进程的PID。</span>
<span class="token class-name">pid_t</span> <span class="token function">waitpid</span><span class="token punctuation">(</span><span class="token class-name">pid_t</span> pid<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">*</span>statusp<span class="token punctuation">,</span> <span class="token keyword">int</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 等待pid子进程停止或终止</span>
<span class="token class-name">pid_t</span> <span class="token function">wait</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 等价于 waitpid(-1, &amp;status, 0)</span>
<span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> secs<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将进程挂起(suspend)指定秒数</span>
<span class="token keyword">int</span> <span class="token function">pause</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将进程挂起，直到该进程收到一个信号</span>
<span class="token comment">// 在当前进程的上下文中加载并运行一个新程序</span>
<span class="token keyword">int</span> <span class="token function">execve</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>filename<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>envp<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h&gt;</span></span>
<span class="token keyword">void</span> <span class="token function">exit</span><span class="token punctuation">(</span><span class="token keyword">int</span> status<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 以status为退出状态终止进程</span>
<span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">getenv</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 返回指定的环境变量</span>
<span class="token keyword">int</span> <span class="token function">setenv</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>name<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>newvalue<span class="token punctuation">,</span> <span class="token keyword">int</span> overwrite<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置环境变量</span>
<span class="token keyword">void</span> <span class="token function">unsetenv</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 删除环境变量</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="fork"><a href="#fork" class="header-anchor">#</a> fork()</h3> <ul><li>fork()函数调用一次，返回两次。在子进程中返回0，在父进程中返回子进程的 PID。</li> <li>fork()函数创建的子进程和所在的进程是并发运行的独立进程。内核能以任意方式交替执行它们的逻辑控制流中的指令。</li> <li>fork()函数创建的子进程拥有相同但独立的地址空间。</li> <li>fork()函数创建的子进程和所在进程共享文件。</li> <li>进程图：每个顶点对应一条程序语句，有向边 a-&gt;b 表示语句 a 在语句 b 之前执行。在 fork 处分为两支。</li></ul> <details class="custom-block details"><summary>例题</summary> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">Fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;p1: x=%d\n&quot;</span><span class="token punctuation">,</span> <span class="token operator">++</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;p2: x=%d\n&quot;</span><span class="token punctuation">,</span> <span class="token operator">--</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 其输出为:</span>
<span class="token comment">// 子进程：p1: x=2  p2: x=1</span>
<span class="token comment">// 父进程：p2: x=0 </span>
<span class="token comment">// 012的出现顺序不定(除了2一定在1前)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></details> <h3 id="waitpid-回收子进程"><a href="#waitpid-回收子进程" class="header-anchor">#</a> waitpid()--回收子进程</h3> <ul><li>进程的回收(reaped)：当一个进程由于某种原因终止时，内核并不是立即把它从系统中清除。相反，进程被保持在一种已终止的状态中，直到被它的父进程回收。当父进程回收已终止的子进程时，内核将子进程的退出状态传递给父进程，然后抛弃已终止的进程，从此时开始，该进程就不存在了。</li> <li>僵死进程(zombie)：终止了，但还没被回收的进程。会消耗内存资源。</li> <li>如果一个父进程终止了，内核会安排 init 进程成为它的子进程的养父。init 进程的 PID 为 1，是在系统启动时由内核创建的，它不会终止，是所有进程的祖先。如果父进程没有回收它的僵死子进程就终止了，那么内核会安排 init 进程去回收它们。</li></ul> <p>waitpid函数</p> <ul><li>通常行为：waitpid挂起调用进程的执行，直到它的等待集合(wait set)中的一个子进程终止。如果等待集合中的一个进程，在waitpid调用时就已经终止了，则立即返回。返回子进程的PID(此时子进程已被回收)。</li> <li>参数 pid：指定等待集合
<ul><li>pid &gt; 0: 等待集合就是pid指定的单独的子进程。</li> <li>pid = -1：等待集合就是父进程的所有子进程。</li> <li>pid = 0：等待集合就是在父进程所在进程组的所有子进程。</li> <li>pid &lt; 0: 等待集合就是在|pid|指定的进程组中的所有子进程。</li></ul></li> <li>参数 options：修改 waitpid 的默认行为
<ul><li>0:默认值。通常行为。</li> <li>WNOHANG:如果等待集合中的一个进程，在 waitpid 调用时就已经终止了，则立即返回。如果等待集合中任何子进程都没有终止，也立即返回，返回值为 0。</li> <li>WUNTRACED:不仅在终止时返回，停止时也返回。(停止的进程不会被回收)</li> <li>WCONTINUED:不仅在终止时返回，在一个停止的程序继续运行时也返回。</li> <li>选项可以组合</li></ul></li> <li>statusp参数指向子进程的退出状态信息status。
<ul><li><code>&lt;sys/wait.h&gt;</code>中定义了一些宏，用于解释status。</li> <li>WIFEXITED(status)：如果于进程通过调用 exit 或者返回正常终止，就返回真。</li> <li>WEXITSTATUS(status)：返回一个正常终止的子进程的退出状态。只有在 WIFEXITED() 返回为真时，才会定义这个状态。</li> <li>WIFSIGNALED(status)：如果子进程是因为一个未被捕获的信号终止的，. 那么就返回真。</li> <li>WTERMSIG(status)：返回导致子进程终止的信号的编号。只有在 WIFSIGNALED() 返回为真时，才定义这个状态。</li> <li>WIFSTOPPED(status)：如果引起返回的子进程当前是停止的，那么就返回真。</li> <li>WSTOPSIG(status)：返回引起子进程停止的信号的编号。只有在 WIFSTOPPED() 返回为真时，才定义这个状态。</li> <li>WIFCONTINUED(status)：如果子进程收到 SIGCONT 信号重新启动，则返回真。</li></ul></li> <li>错误条件
<ul><li>如果调用进程没有子进程(没创建或者已经回收完了)，则 waitpid 返回 -1，并设置 errno 为 ECHILD。</li> <li>如果 waitpid 函数被一个信号中断，则返回 -1，并设置 errno 为 EINTR。</li></ul></li></ul> <h3 id="execve函数"><a href="#execve函数" class="header-anchor">#</a> execve函数</h3> <ul><li>execve 函数在当前进程上下文中加载并运行一个新程序，并会<strong>覆盖</strong>当前进程的地址空间，不会创建新进程，而是继承原进程的PID和已打开文件列表。</li> <li>execve 参数列表中，filename 为要加载的可执行目标文件， argv，envp 为传递给 main 函数的参数。</li> <li>execve 加载 filename 后，调用_start()启动代码，启动代码设置栈，并将控制传递给新程序的 main 函数。</li> <li>main 函数的原型 <code>int main(int argc, char *argv[], char *envp[]);</code> <ul><li>argc 为 argv 数组中非空指针的数量</li> <li>agrv 数组中 <code>argv[0]</code> 为可执行目标文件名，之后为执行时所带的参数列表。</li> <li>envp 数组保存环境变量字符串(内容为&quot;name=value&quot;的键值对)。</li></ul></li></ul> <h2 id="信号"><a href="#信号" class="header-anchor">#</a> 信号</h2> <ul><li>一种比硬件异常，上下文切换更高层的软件形式异常，它允许进程和内核中断其他进程。</li> <li>一个信号就是一个消息，它通知进程系统中发生了一个某类型的事件。</li> <li>某种信号类型对应每种系统事件。</li></ul> <table><thead><tr><th>序号</th> <th>名称</th> <th>默认行为</th> <th>相应事件</th></tr></thead> <tbody><tr><td>1</td> <td>SIGHUP</td> <td>终止</td> <td>终端线挂断</td></tr> <tr><td>2</td> <td>SIGINT</td> <td>终止</td> <td>来自键盘的中断</td></tr> <tr><td>3</td> <td>SIGQUIT</td> <td>终止</td> <td>来自键盘的退出</td></tr> <tr><td>4</td> <td>SIGILL</td> <td>终止</td> <td>非法指令</td></tr> <tr><td>5</td> <td>SIGTRAP</td> <td>终止并转储内存</td> <td>跟踪陷阱</td></tr> <tr><td>6</td> <td>SIGABRT</td> <td>终止并转储内存</td> <td>来自 abort 函数的终止信号</td></tr> <tr><td>7</td> <td>SIGBUS</td> <td>终止</td> <td>总线错误</td></tr> <tr><td>8</td> <td>SIGFPE</td> <td>终止并转储内存</td> <td>浮点异常</td></tr> <tr><td>9</td> <td>SIGKILL</td> <td>终止</td> <td>杀死程序</td></tr> <tr><td>10</td> <td>SIGUSR1</td> <td>终止</td> <td>用户定义的信号 1</td></tr> <tr><td>11</td> <td>SIGSEGV</td> <td>终止并转储内存</td> <td>无效的内存引用（段故障）</td></tr> <tr><td>12</td> <td>SIGUSR2</td> <td>终止</td> <td>用户定义的信号 2</td></tr> <tr><td>13</td> <td>SIGPIPE</td> <td>终止</td> <td>向一个没有读用户的管道做写操作</td></tr> <tr><td>14</td> <td>SIGALRM</td> <td>终止</td> <td>来自 alarm 函数的定时器信号</td></tr> <tr><td>15</td> <td>SIGTERM</td> <td>终止</td> <td>软件终止信号</td></tr> <tr><td>16</td> <td>SIGSTKFLT</td> <td>终止</td> <td>协处理器上的栈故障</td></tr> <tr><td>17</td> <td>SIGCHLD</td> <td>忽略</td> <td>一个子进程停止或者终止</td></tr> <tr><td>18</td> <td>SIGCONT</td> <td>忽略</td> <td>继续进程如果该进程停止</td></tr> <tr><td>19</td> <td>SIGSTOP</td> <td>停止直到下一个SIGCONT</td> <td>不是来自终端的停止信号</td></tr> <tr><td>20</td> <td>SIGTSTP</td> <td>停止直到下一个SIGCONT</td> <td>来自终端的停止信号</td></tr> <tr><td>21</td> <td>SIGTTIN</td> <td>停止直到下一个SIGCONT</td> <td>后台进程从终端读</td></tr> <tr><td>22</td> <td>SIGTTOU</td> <td>停止直到下一个SIGCONT</td> <td>后台进程向终端写</td></tr> <tr><td>23</td> <td>SIGURG</td> <td>忽略</td> <td>套接字上的紧急情况</td></tr> <tr><td>24</td> <td>SIGXCPU</td> <td>终止</td> <td>CPU 时间限制超出</td></tr> <tr><td>25</td> <td>SIGXFSZ</td> <td>终止</td> <td>文件大小限制超出</td></tr> <tr><td>26</td> <td>SIGVTALRM</td> <td>终止</td> <td>虚拟定时器期满</td></tr> <tr><td>27</td> <td>SIGPROF</td> <td>终止</td> <td>剖析定时器期满</td></tr> <tr><td>28</td> <td>SIGWINCH</td> <td>忽略</td> <td>窗口大小变化</td></tr> <tr><td>29</td> <td>SIGIO</td> <td>终止</td> <td>在某个描述符上可执行 I/O 操作</td></tr> <tr><td>30</td> <td>SIGPWR</td> <td>终止</td> <td>电源故障</td></tr></tbody></table> <h3 id="信号术语"><a href="#信号术语" class="header-anchor">#</a> 信号术语</h3> <ul><li>发送信号：内核通过<strong>更新目的进程上下文中的某个状态</strong>，发送一个信号给目的进程。需要发送信号的两种原因
<ul><li>内核检测到某个系统事件，如除零错误或子进程终止。</li> <li>一个进程调用了 kill 函数。</li></ul></li> <li>接收信号：当目的进程被内核强迫以某种方式对信号作出反应时，它就接收了信号。有三种反应
<ul><li>忽略信号</li> <li>终止进程</li> <li>捕获信号：即调用信号处理程序。</li></ul></li> <li>待处理信号(pending signal)：发出了，但没被处理的信号。在任意时刻，对一个进程而言，每个信号类型最多有一个待处理信号，后续发到该进程的同类型信号会被丢弃。也就是说，一个进程，最多接收一个信号(正在处理)并有一个同类型的待处理信号。</li> <li>阻塞：对于信号 k，进程 p 第一次收到信号 k 时，p 接收 k，并作出合理反应。在此期间，第二次收到信号 k 时，k 就处于待处理状态，此时就说信号 k 被隐式阻塞了。如果继续收到信号 k，直接丢弃。</li> <li>内核为每个进程维护两个信号集合
<ul><li>在 pending 位向量中维护待处理信号集合(被隐式阻塞的信号集合)</li> <li>在 blocked 位向量中维护被阻塞的信号集合(用sigprocmask()函数阻塞的)</li></ul></li></ul> <h3 id="发送信号"><a href="#发送信号" class="header-anchor">#</a> 发送信号</h3> <ul><li>/bin/kill 程序：kill -sigid pid。具体见man kill。</li> <li>键盘：shell 中使用 job 表示进程。
<ul><li>Ctrl+C：内核发送一个 SIGINTR 信号到前台进程组中的每个进程。默认结果为终止前台进程。</li> <li>Ctrl+Z：内核发送一个 SIGTSTP 信号到前台进程组中的每个进程。默认结果为停止前台进程。</li></ul></li> <li>kill() 函数</li> <li>alarm() 函数，向进程自己发送 SIGALRM 信号。</li></ul> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/types.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;signal.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">kill</span><span class="token punctuation">(</span><span class="token class-name">pid_t</span> pid<span class="token punctuation">,</span> <span class="token keyword">int</span> sig<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 向pid进程发送sig信号</span>
<span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token function">alarm</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> secs<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 在secs后发送一个 SIGALRM 信号给自己。</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="接收信号"><a href="#接收信号" class="header-anchor">#</a> 接收信号</h3> <p>当内核将进程 p 从内核模式切换到用户模式时，它会检查进程 p 的为被阻塞的待处理信号的集合(pending &amp; ~blocked)。如果集合为空，内核将控制直接传给 p 的逻辑控制流中的下一条指令。如果集合非空，则选择某个信号 k (通常是最小的)，并且强制 p 接收信号 k。引起相应的行为(终止，终止+转储内存(Core dump)，停止，执行信号处理程序)。</p> <p>进程可以通过 signal 函数修改和信号相关联的默认行为，除了 SIGSTOP 和 SIGKILL。</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;signal.h&gt;</span></span>
<span class="token keyword">typedef</span> <span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token class-name">sighandler_t</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">sighandler_t</span> <span class="token function">signal</span><span class="token punctuation">(</span><span class="token keyword">int</span> signum<span class="token punctuation">,</span> <span class="token class-name">sighandler_t</span> handler<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置 signum 信号的信号处理程序为 handler。</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>其中 handler 可以是：</p> <ul><li>SIG_IGN：忽略信号</li> <li>SIG_DFL：信号的默认行为</li> <li>用户自定义函数。这个函数称为信号处理程序。调用信号处理程序称为<strong>捕获信号</strong>，执行信号处理程序称为<strong>处理信号</strong>。</li> <li>信号处理程序可以被其他信号处理程序中断。</li></ul> <h3 id="信号的阻塞和解除"><a href="#信号的阻塞和解除" class="header-anchor">#</a> 信号的阻塞和解除</h3> <ul><li>隐式阻塞机制：内核默认阻塞任何当前处理程序正在处理的信号类型的待处理信号。</li> <li>显示阻塞机制：使用 sigprocmask 函数设置。</li></ul> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;signal.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">sigprocmask</span><span class="token punctuation">(</span><span class="token keyword">int</span> how<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token class-name">sigset_t</span> <span class="token operator">*</span>set<span class="token punctuation">,</span> <span class="token class-name">sigset_t</span> <span class="token operator">*</span>oldset<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置blocked位向量，阻塞信号。</span>
<span class="token keyword">int</span> <span class="token function">sigempty</span><span class="token punctuation">(</span><span class="token class-name">sigset_t</span> <span class="token operator">*</span>set<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 初始化 set 为空集合</span>
<span class="token keyword">int</span> <span class="token function">sigfillset</span><span class="token punctuation">(</span><span class="token class-name">sigset_t</span> <span class="token operator">*</span>set<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 初始化 set 为选择所有信号的集合</span>
<span class="token keyword">int</span> <span class="token function">sigaddset</span><span class="token punctuation">(</span><span class="token class-name">sigset_t</span> <span class="token operator">*</span>set<span class="token punctuation">,</span> <span class="token keyword">int</span> signum<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 将 signum 添加到 set</span>
<span class="token keyword">int</span> <span class="token function">sigdelset</span><span class="token punctuation">(</span><span class="token class-name">sigset_t</span> <span class="token operator">*</span>set<span class="token punctuation">,</span> <span class="token keyword">int</span> signum<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 从 set 中删除 signum</span>
<span class="token keyword">int</span> <span class="token function">sigismember</span><span class="token punctuation">(</span><span class="token class-name">sigset_t</span> <span class="token operator">*</span>set<span class="token punctuation">,</span> <span class="token keyword">int</span> signum<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 判断 signum 是不是 set 的成员</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>其中，how</p> <ul><li>SIG_BLOCK： 将 set 中的信号添加到 blocked 中(blocked = blocked | set)</li> <li>SIG_UNBLOCK： blocked = blocked &amp; ~set</li> <li>SIG_SETMASK：blocked = set</li></ul> <h3 id="编写信号处理程序"><a href="#编写信号处理程序" class="header-anchor">#</a> 编写信号处理程序</h3> <p>信号处理是 Linux 系统编程最棘手的一个问题。因为</p> <ul><li>处理程序和主程序并发运行，共享同样的全局变量</li> <li>如何及何时接收信号的规则常常违反人的直觉</li> <li>不同系统有不同的信号处理语义</li></ul> <p>//TODO</p> <ul><li>信号时不排队的，每种信号最多一个正在处理，一个待处理，其余都是直接丢弃。因此，关于信号的一个关键思想是：如果存在一个未处理的信号，就表明至少有一个信号到达了。</li> <li>ps命令输出中的<code>&lt;defunct&gt;</code>表明进程为僵死进程。</li></ul> <h2 id="非本地跳转"><a href="#非本地跳转" class="header-anchor">#</a> 非本地跳转</h2> <p>另一种用户级异常控制流形式。通过 setjump 和 longjump 函数提供。</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;setjmp.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">setjmp</span><span class="token punctuation">(</span>jmp_buf env<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 在 env 缓冲区中保存当前调用环境，供longjmp使用，返回0。</span>
<span class="token keyword">void</span> <span class="token function">longjmp</span><span class="token punctuation">(</span>jmp_buf env<span class="token punctuation">,</span> <span class="token keyword">int</span> retval<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 从 env 缓冲区中恢复调用环境，然后触发一个最近一次初始化 env 的 setjmp 调用的返回。然后 setjmp 返回，返回值为非零的 retval。</span>
<span class="token comment">// 下面这两个是可被信号处理函数使用的版本。(但都不是异步信号安全的函数)</span>
<span class="token keyword">int</span> <span class="token function">sigsetjump</span><span class="token punctuation">(</span>sigjmp_buf env<span class="token punctuation">,</span> <span class="token keyword">int</span> savesigs<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">void</span> <span class="token function">siglongjmp</span><span class="token punctuation">(</span>sigjmp_buf env<span class="token punctuation">,</span> <span class="token keyword">int</span> retval<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>longjmp不返回，而是直接跳转到最近的setjmp，让setjmp再次返回。</p> <p>非本地跳转的一个重要应用就是允许从一个深层嵌套的函数调用中立即返回，通常是由检测到某个错误情况引起的。</p> <details class="custom-block details"><summary>示例</summary> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;csapp.h&quot;</span></span>

jmp_buf buf<span class="token punctuation">;</span>

<span class="token keyword">int</span> error1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> error2 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token function">setjmp</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span>
        <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Detected an error1 condition in foo\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Detected an error2 condition in foo\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Unknown error condition in foo\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* Deeply nested function foo */</span>
<span class="token keyword">void</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>error1<span class="token punctuation">)</span>
        <span class="token function">longjmp</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>error2<span class="token punctuation">)</span>
        <span class="token function">longjmp</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div></details> <p>非本地跳转的另一个重要应用是使一个信号处理程序分支到一个特殊的代码位置，而不是返回到被信号到达中断了的指令的位置。</p> <details class="custom-block details"><summary>示例</summary> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;csapp.h&quot;</span></span>

sigjmp_buf buf<span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">handler</span><span class="token punctuation">(</span><span class="token keyword">int</span> sig<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">siglongjmp</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">sigsetjmp</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">Signal</span><span class="token punctuation">(</span>SIGINT<span class="token punctuation">,</span> handler<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">Sio_puts</span><span class="token punctuation">(</span><span class="token string">&quot;starting\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span>
        <span class="token function">Sio_puts</span><span class="token punctuation">(</span><span class="token string">&quot;restarting\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">Sio_puts</span><span class="token punctuation">(</span><span class="token string">&quot;processing...\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* Control never reaches here */</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div></details> <h2 id="操作进程的工具"><a href="#操作进程的工具" class="header-anchor">#</a> 操作进程的工具</h2> <ul><li>STRACE</li> <li>PS</li> <li>TOP</li> <li>PMAP</li></ul></div> <!----> <div class="content__content-bottom"></div> <footer class="page-meta"><!----> <div class="meta-item update-time"><span class="label">Last update:</span> <span class="info">2021年10月3日 10:18</span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/note/cs/linux/" class="prev"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon prev-icon"><path d="M906.783 588.79c-.02 8.499-6.882 15.36-15.38 15.37l-443.7-.01 75.704 191.682c2.52 6.42.482 13.763-5.038 17.91-5.52 4.168-13.138 4.147-18.616-.092L123.228 524.175a15.362 15.362 0 0 1-6-12.165c0-4.782 2.222-9.277 6-12.185L499.753 210.35a15.388 15.388 0 0 1 9.38-3.195c3.236 0 6.502 1.034 9.236 3.103 5.52 4.147 7.578 11.49 5.038 17.91L447.683 419.84l443.72-.01c8.498.01 15.36 6.881 15.36 15.36l.02 153.6z" fill="currentColor"></path></svg>
        Linux - Ubantu
      </a></span> <span class="next"><a href="/note/cs/VM/">
        虚拟内存
        <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon next-icon"><path d="M906.772 512c0 4.772-2.211 9.267-5.99 12.175L524.257 813.66a15.37 15.37 0 0 1-18.616.092 15.368 15.368 0 0 1-5.038-17.91l75.714-191.672h-443.73c-8.488 0-15.36-6.881-15.36-15.36v-153.6c0-8.489 6.872-15.36 15.36-15.36h443.73l-75.714-191.682a15.358 15.358 0 0 1 5.048-17.91c5.51-4.158 13.128-4.137 18.606.092l376.525 289.485a15.323 15.323 0 0 1 5.99 12.165z" fill="currentColor"></path></svg></a></span></p></div> <!----> <!----> <div class="content__page-bottom"></div></main> <footer class="footer-wrapper"><div class="media-links-wrapper"><a href="https://zhihu.com" rel="noopener noreferrer" target="_blank" aria-label="Zhihu" data-balloon-pos="up" class="media-link"><span class="sr-only">Zhihu</span> <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon icon-zhihu"><circle cx="512" cy="512" r="512" fill="#006CE2"></circle> <path d="M513.65 491.261H411.551c1.615-16.154 5.815-60.095 5.815-84.973 0-24.88-.323-60.742-.323-60.742h102.744V329.39c0-21.647-9.37-31.34-17.124-31.34h-178.67s5.169-17.77 10.015-36.186c4.846-18.417 15.832-44.264 15.832-44.264-63.003 4.2-67.958 50.941-81.743 92.729-13.787 41.785-24.556 62.356-44.586 107.912 27.786 0 55.249-13.57 66.879-32.309 11.631-18.74 16.908-40.71 16.908-40.71h62.035v59.019c0 21.107-3.878 87.45-3.878 87.45H254.742c-19.386 0-29.724 48.894-29.724 48.894h133.76c-8.4 75.82-26.493 106.191-51.91 152.716-25.418 46.525-92.728 99.406-92.728 99.406 41.033 11.63 86.589-3.555 105.974-21.972 19.386-18.417 35.863-49.756 47.817-72.838 11.954-23.081 21.972-65.124 21.972-65.124L498.462 766.86s4.846-24.233 6.461-39.418c1.616-15.186-.755-26.385-4.63-35.433-3.878-9.046-15.509-21.54-31.018-39.634-15.507-18.094-48.034-52.879-48.034-52.879s-15.832 11.63-28.108 21.001c9.046-21.97 16.262-79.695 16.262-79.695h122.343v-20.249c.003-17.66-7.319-29.29-18.089-29.29zm287.337-200.747h-234.35a4.308 4.308 0 0 0-4.309 4.308v435.099a4.308 4.308 0 0 0 4.308 4.308h40.226l14.7 50.402 81.096-50.402h98.328a4.308 4.308 0 0 0 4.308-4.308v-435.1a4.308 4.308 0 0 0-4.308-4.308zM755.97 684.47h-52.343l-61.548 39.095-10.823-39.095h-18.738V338.116H755.97v346.355z" fill="#FFF"></path></svg></a><a href="https://baidu.com" rel="noopener noreferrer" target="_blank" aria-label="Baidu" data-balloon-pos="up" class="media-link"><span class="sr-only">Baidu</span> <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon icon-baidu"><circle cx="512" cy="512" r="512" fill="#1D2FE3"></circle> <path d="M239.022 704.978c.098-4.865-.314-9.772.162-14.591 5.178-52.464 197.571-253.377 249.641-259.233 42.996-4.833 75.768 16.545 99.824 49.144 37.893 51.351 82.81 95.455 131.292 136.237 52.903 44.503 56.525 99.801 32.6 158.592-23.425 57.56-75.34 69.833-127.771 58.804-84.971-17.874-168.158-13.744-253.37-4.536-86.35 9.333-133.788-39.4-132.378-124.417zM352.464 412.86c-3.58 50.707-17.93 96.128-75.9 98.12-58.053 1.995-80.093-41.432-79.275-91.71.81-49.705 13.416-104.053 76.851-102.136 53.84 1.625 74.74 45.8 78.324 95.726zm386.053 142.168c-68.494-1.735-84.188-43.331-82.635-93.812 1.46-47.519 10.082-97.628 73.299-96.65 61.395.95 81.6 43.207 81.553 98.668-.047 53.156-19.818 89.398-72.217 91.794zm-45.235-278.345c-10.464 42.665-24.513 91.761-85.919 94.502-52.74 2.354-71.705-34.482-72.805-81.242-1.233-52.42 48.08-112.965 87.582-110.373 33.943 2.226 71.146 49.541 71.142 97.113zm-195.147-14.097c-7.005 46.274-13.63 100.025-71.562 101.351-57.077 1.306-73.567-47.922-73.638-97.109-.068-48.054 12.128-99.024 69.345-101.426 59.45-2.493 67.11 51.093 75.855 97.184z" fill="#fff"></path> <path d="M479.52 663.165c.006 12.194 1.498 24.61-.284 36.537-4.707 31.503 18.862 78.749-45.326 77.534-54.226-1.027-103.338-3.31-113.231-73.536-7.164-50.852 7.78-85.674 57.687-102.668 17.67-6.016 39.618 5.058 54.096-14.548 10.84-14.679-2.901-54.592 33.418-41.47 24.075 8.7 11.477 38.922 13.278 59.652 1.68 19.366.359 38.99.363 58.5zm175.45 41.902c4.291 39.657 5.093 78.047-64.709 73.503-60.097-3.912-95.56-20.794-86.293-85.624 4.287-29.991-21.148-83.238 22.19-84.867 42.71-1.606 13.57 50.41 20.825 77.622 5.276 19.794-3.984 46.774 29.753 48.193 41.337 1.738 28.383-30.022 31.099-51.604 1.209-9.61-.85-19.65.528-29.215 2.516-17.474-8.928-44.716 19.554-47.191 36.044-3.133 24.155 28.376 26.678 47.523 1.896 14.387.375 29.225.375 51.66z" fill="#1D2FE3"></path> <path d="M435.669 685.038c-2.255 24.07 5.605 53.68-33.623 52.136-34.594-1.362-35.274-31.818-38.513-53.078-4.028-26.448 11.38-48.18 40.785-50.023 40.967-2.564 27.097 30.764 31.35 50.965z" fill="#fff"></path></svg></a><a href="https://github.com" rel="noopener noreferrer" target="_blank" aria-label="Github" data-balloon-pos="up" class="media-link"><span class="sr-only">Github</span> <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon icon-github"><circle cx="512" cy="512" r="512" fill="#171515"></circle> <path d="M509.423 146.442c-200.317 0-362.756 162.42-362.756 362.8 0 160.266 103.936 296.24 248.109 344.217 18.139 3.327 24.76-7.872 24.76-17.486 0-8.613-.313-31.427-.49-61.702-100.912 21.923-122.205-48.63-122.205-48.63-16.495-41.91-40.28-53.067-40.28-53.067-32.937-22.51 2.492-22.053 2.492-22.053 36.407 2.566 55.568 37.386 55.568 37.386 32.362 55.438 84.907 39.43 105.58 30.143 3.296-23.444 12.667-39.43 23.032-48.498-80.557-9.156-165.246-40.28-165.246-179.297 0-39.604 14.135-71.988 37.342-97.348-3.731-9.178-16.18-46.063 3.556-96.009 0 0 30.46-9.754 99.76 37.19 28.937-8.048 59.97-12.071 90.823-12.211 30.807.14 61.843 4.165 90.822 12.21 69.26-46.944 99.663-37.189 99.663-37.189 19.792 49.946 7.34 86.831 3.61 96.01 23.25 25.359 37.29 57.742 37.29 97.347 0 139.366-84.82 170.033-165.637 179.013 13.026 11.2 24.628 33.342 24.628 67.182 0 48.498-.445 87.627-.445 99.521 0 9.702 6.535 20.988 24.945 17.444 144.03-48.067 247.881-183.95 247.881-344.175 0-200.378-162.442-362.798-362.802-362.798z" fill="#FFF"></path></svg></a></div> <div class="footer">Less interests, more interest.</div> <div class="copyright">Copyright © 2021 Leonhardt</div></footer></div><div class="global-ui"><!----><!----><div id="pwa-install"><!----> <div id="install-modal-wrapper" style="display:none;"><div class="background"></div> <div class="install-modal"><div class="header"><button aria-label="Close" class="close-button"><svg width="23" height="22" xmlns="http://www.w3.org/2000/svg" class="icon close-icon"><path fill-rule="evenodd" clip-rule="evenodd" d="M1.12.358a1.224 1.224 0 011.729 0l8.92 8.914L20.686.358a1.224 1.224 0 011.73 1.728L13.497 11l8.92 8.913a1.222 1.222 0 11-1.73 1.729l-8.919-8.913-8.92 8.913a1.224 1.224 0 01-1.729-1.729L10.04 11l-8.92-8.914a1.222 1.222 0 010-1.728z" fill="currentColor"></path></svg></button> <div class="logo"><!----> <div class="title"><h1></h1> <p class="desc">This app can be installed on your PC or mobile device.  This will allow this web app to look and behave like any other installed app.  You will find it in your app lists and be able to pin it to your home screen, start menus or task bars.  This installed web app will also be able to safely interact with other apps and your operating system. </p></div></div></div> <div class="content"><div class="highlight"><!----> <!----></div> <div class="description"><h3>Description</h3> <p></p></div></div> <div class="button-wrapper"><button class="install-button">
        Install <span></span></button> <button class="cancel-button">
        Cancel
      </button></div></div></div></div><div tabindex="-1" role="dialog" aria-hidden="true" class="pswp"><div class="pswp__bg"></div> <div class="pswp__scroll-wrap"><div class="pswp__container"><div class="pswp__item"></div> <div class="pswp__item"></div> <div class="pswp__item"></div></div> <div class="pswp__ui pswp__ui--hidden"><div class="pswp__top-bar"><div class="pswp__counter"></div> <button class="pswp__button pswp__button--close"></button> <button class="pswp__button pswp__button--share"></button> <button class="pswp__button pswp__button--fs"></button> <button class="pswp__button pswp__button--zoom"></button> <div class="pswp__preloader"><div class="pswp__preloader__icn"><div class="pswp__preloader__cut"><div class="pswp__preloader__donut"></div></div></div></div></div> <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class="pswp__share-tooltip"></div></div> <button class="pswp__button pswp__button--arrow--left"></button> <button class="pswp__button pswp__button--arrow--right"></button> <div class="pswp__caption"><div class="pswp__caption__center"></div></div></div></div></div></div></div>
    <script src="/assets/js/app.2bdc4ba3.js" defer></script><script src="/assets/js/vendors~layout-Layout.6d9d91f8.js" defer></script><script src="/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound.a42f9c7b.js" defer></script><script src="/assets/js/page-异常控制流.f13df06b.js" defer></script><script src="/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound~layout-Slide.d0bef86f.js" defer></script>
  </body>
</html>
