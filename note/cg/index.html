<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>计算机图形学 | My Documentations</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/2.10.0/github-markdown.min.css">
    <script src="https://cdn.jsdelivr.net/npm/react/umd/react.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/react-dom/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@babel/standalone/babel.min.js"></script>
    <meta name="description" content="Just playing around">
    
    <link rel="preload" href="/assets/css/0.styles.b27f4404.css" as="style"><link rel="preload" href="/assets/js/app.f6ce4901.js" as="script"><link rel="preload" href="/assets/js/2.f48cadb2.js" as="script"><link rel="preload" href="/assets/js/14.23a1db9c.js" as="script"><link rel="prefetch" href="/assets/js/10.3a13d91f.js"><link rel="prefetch" href="/assets/js/11.6dfc7746.js"><link rel="prefetch" href="/assets/js/12.e362ecf7.js"><link rel="prefetch" href="/assets/js/13.3c9b997b.js"><link rel="prefetch" href="/assets/js/15.8b3a561f.js"><link rel="prefetch" href="/assets/js/16.2ac120e5.js"><link rel="prefetch" href="/assets/js/17.f345ec1b.js"><link rel="prefetch" href="/assets/js/18.1048dfd6.js"><link rel="prefetch" href="/assets/js/19.2523d903.js"><link rel="prefetch" href="/assets/js/20.b286de47.js"><link rel="prefetch" href="/assets/js/21.23cc0f55.js"><link rel="prefetch" href="/assets/js/22.c82709a4.js"><link rel="prefetch" href="/assets/js/23.581733e2.js"><link rel="prefetch" href="/assets/js/24.0a11e006.js"><link rel="prefetch" href="/assets/js/25.a18b9b80.js"><link rel="prefetch" href="/assets/js/26.c9b8b24f.js"><link rel="prefetch" href="/assets/js/27.e7d03654.js"><link rel="prefetch" href="/assets/js/28.62112090.js"><link rel="prefetch" href="/assets/js/29.8b2b87e8.js"><link rel="prefetch" href="/assets/js/3.c394873f.js"><link rel="prefetch" href="/assets/js/30.d9c7c7b9.js"><link rel="prefetch" href="/assets/js/31.8563e8bf.js"><link rel="prefetch" href="/assets/js/32.82fbaf29.js"><link rel="prefetch" href="/assets/js/33.fbd08eaa.js"><link rel="prefetch" href="/assets/js/34.752ff075.js"><link rel="prefetch" href="/assets/js/35.555c100b.js"><link rel="prefetch" href="/assets/js/36.caa5aa97.js"><link rel="prefetch" href="/assets/js/37.73268eb3.js"><link rel="prefetch" href="/assets/js/38.5a055bbe.js"><link rel="prefetch" href="/assets/js/39.72d746d1.js"><link rel="prefetch" href="/assets/js/4.d1b6e8ed.js"><link rel="prefetch" href="/assets/js/40.817e0f8e.js"><link rel="prefetch" href="/assets/js/41.e27a11fe.js"><link rel="prefetch" href="/assets/js/5.7d8c4629.js"><link rel="prefetch" href="/assets/js/6.3a2a2487.js"><link rel="prefetch" href="/assets/js/7.705f55e4.js"><link rel="prefetch" href="/assets/js/8.5ceedde8.js"><link rel="prefetch" href="/assets/js/9.721e9c1c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b27f4404.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/assets/img/ChernoLogo.png" alt="My Documentations" class="logo"> <span class="site-name can-hide">My Documentations</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="/blog/" class="nav-link">
  Blog
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Note" class="dropdown-title"><span class="title">Note</span> <span class="arrow down"></span></button> <button type="button" aria-label="Note" class="mobile-dropdown-title"><span class="title">Note</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note/cg/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Computer Graphics
</a></li><li class="dropdown-item"><!----> <a href="/note/gea/" class="nav-link">
  Game Engine Architecture
</a></li><li class="dropdown-item"><!----> <a href="/note/cpp/" class="nav-link">
  C/C++
</a></li><li class="dropdown-item"><!----> <a href="/note/opengl/" class="nav-link">
  OpenGL
</a></li><li class="dropdown-item"><!----> <a href="/note/js/" class="nav-link">
  JavaScript
</a></li></ul></div></div><div class="nav-item"><a href="/hazel/" class="nav-link">
  Hazel
</a></div> <a href="https://github.com/kigane/MyBlogs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/guide/" class="nav-link">
  Guide
</a></div><div class="nav-item"><a href="/blog/" class="nav-link">
  Blog
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Note" class="dropdown-title"><span class="title">Note</span> <span class="arrow down"></span></button> <button type="button" aria-label="Note" class="mobile-dropdown-title"><span class="title">Note</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/note/cg/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Computer Graphics
</a></li><li class="dropdown-item"><!----> <a href="/note/gea/" class="nav-link">
  Game Engine Architecture
</a></li><li class="dropdown-item"><!----> <a href="/note/cpp/" class="nav-link">
  C/C++
</a></li><li class="dropdown-item"><!----> <a href="/note/opengl/" class="nav-link">
  OpenGL
</a></li><li class="dropdown-item"><!----> <a href="/note/js/" class="nav-link">
  JavaScript
</a></li></ul></div></div><div class="nav-item"><a href="/hazel/" class="nav-link">
  Hazel
</a></div> <a href="https://github.com/kigane/MyBlogs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/note/cg/" aria-current="page" class="active sidebar-link">计算机图形学</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/cg/#图形领域-graphics-areas" class="sidebar-link">图形领域(Graphics Areas)</a></li><li class="sidebar-sub-header"><a href="/note/cg/#主要应用" class="sidebar-link">主要应用</a></li><li class="sidebar-sub-header"><a href="/note/cg/#api" class="sidebar-link">API</a></li><li class="sidebar-sub-header"><a href="/note/cg/#图形管线-graphics-pipeline" class="sidebar-link">图形管线(Graphics pipeline)</a></li><li class="sidebar-sub-header"><a href="/note/cg/#浮点数问题" class="sidebar-link">浮点数问题</a></li><li class="sidebar-sub-header"><a href="/note/cg/#效率" class="sidebar-link">效率</a></li><li class="sidebar-sub-header"><a href="/note/cg/#设计和编写图形程序" class="sidebar-link">设计和编写图形程序</a></li></ul></li><li><a href="/note/cg/ch8.html" class="sidebar-link">第八章 图形管线(The Graphics Pipeline)</a></li><li><a href="/note/cg/ch10.html" class="sidebar-link">表面着色</a></li><li><a href="/note/cg/ch11.html" class="sidebar-link">纹理</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>计算机图形学，简而言之，是在用各种方式使用计算机创造和操纵图像。</p> <h2 id="图形领域-graphics-areas"><a href="#图形领域-graphics-areas" class="header-anchor">#</a> 图形领域(Graphics Areas)</h2> <p>最主要的</p> <ul><li>建模(Modeling)：涉及到以一种计算机可存储的方式处理形状和外观属性的数学规约。</li> <li>渲染(Rendering)：涉及3D模型的上色。</li> <li>动画(Animation)：通过图像序列创造运动的幻觉。在建模和渲染之外，涉及到随时间推移运动的关键问题。</li></ul> <p>其他相关的</p> <ul><li>用户交互(User interaction)</li> <li>虚拟现实(Virtual reality)</li> <li>可视化(Visualization)</li> <li>图像处理(Image processing)</li> <li>3D扫描(3D scanning)</li> <li>计算摄影(Computational photography)</li></ul> <h2 id="主要应用"><a href="#主要应用" class="header-anchor">#</a> 主要应用</h2> <ul><li>视频游戏(Video games)</li> <li>动画(Cartoons)</li> <li>视觉效果(Visual effects)</li> <li>动画电影(Animated film)</li> <li>CAD/CAM(computer-aided design/manufacturing)</li> <li>模拟(Simulation)</li> <li>医学影像(Medical imaging)</li> <li>信息可视化(Information visualization)</li></ul> <h2 id="api"><a href="#api" class="header-anchor">#</a> API</h2> <p>整合途径，如Java packages。</p> <p>图形库，如OpenGL和Direct3D</p> <h2 id="图形管线-graphics-pipeline"><a href="#图形管线-graphics-pipeline" class="header-anchor">#</a> 图形管线(Graphics pipeline)</h2> <p>现如今，每台桌面电脑都有一个强大的3D图形管线，它是一种特殊的可以高效绘制3D基本体(primitives)透视的软件/硬件子系统。通常这些系统对处理有共享顶点的3D三角形有优化。管线中的基本操作将3D顶点位置映射到2D屏幕位置并为三角形上色，以使它们看起来逼真并以适当的前后顺序显示。</p> <p>将三角形以有效的前后顺序显示曾经是计算机图形学中最重要的研究问题，到如今，已经可以使用z-buffer(以一个特殊的内存缓冲暴力的解决)几乎解决了。</p> <p>事实上图形管线中使用的几何操作可以使用4D(三个传统几何坐标和一个齐次坐标帮助处理透视图)齐次坐标空间几乎完全完成。因此图形管线中有许多硬件负责处理4x4的矩阵和4维向量。4D坐标系是计算机图形学中最微妙，最美丽的结构之一，也是在学习计算机图形学时需要跨越的最大障碍。</p> <p>图像生成的速度很大程度上依赖于需要绘制的三角形数量。又因为在许多应用中，交互性比图像质量更重要，所以就需要尽量减少模型的三角形数量。此外，如果模型在远处被观察时需要的三角形数量显然要比在近处少，这提示我们用变化的细节层次(level of detail, LOD)代表模型会很有用。</p> <h2 id="浮点数问题"><a href="#浮点数问题" class="header-anchor">#</a> 浮点数问题</h2> <p>在图形学中需要注意的特殊浮点数值：</p> <ul><li>Infinity(\infin)：比任何其他有效值都大的数。</li> <li>Minus infinity(-\infin)：比任何其他有效值都小的数。</li> <li>Not a number(NaN)：来自结果没有定义的操作的无效值，例如，0/0。
<ul><li>任何包括NaN的算数表达式结果仍是NaN。</li> <li>任何包括NaN的布尔表达式结果是FALSE。</li></ul></li></ul> <p>特殊的IEEE浮点数计算规则：</p> <p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mtable><mtr><mtd><mrow><mrow><mo>+</mo><mi>a</mi><mi mathvariant="normal">/</mi><mo>(</mo><mo>+</mo><mi mathvariant="normal">∞</mi><mo>)</mo><mo>=</mo><mo>+</mo><mn>0</mn></mrow></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mo>−</mo><mi>a</mi><mi mathvariant="normal">/</mi><mo>(</mo><mo>+</mo><mi mathvariant="normal">∞</mi><mo>)</mo><mo>=</mo><mo>−</mo><mn>0</mn></mrow></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mo>+</mo><mi>a</mi><mi mathvariant="normal">/</mi><mo>(</mo><mo>−</mo><mi mathvariant="normal">∞</mi><mo>)</mo><mo>=</mo><mo>−</mo><mn>0</mn></mrow></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mo>−</mo><mi>a</mi><mi mathvariant="normal">/</mi><mo>(</mo><mo>−</mo><mi mathvariant="normal">∞</mi><mo>)</mo><mo>=</mo><mo>+</mo><mn>0</mn></mrow></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">\left. \begin{array} { l } { + a / ( + \infty ) = + 0 } \\ { - a / ( + \infty ) = - 0 } \\ { + a / ( - \infty ) = - 0 } \\ { - a / ( - \infty ) = + 0 } \end{array} \right.</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:2.6500000000000004em;"></span><span class="strut bottom" style="height:4.800000000000001em;vertical-align:-2.1500000000000004em;"></span><span class="base textstyle uncramped"><span class="minner textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist"><span style="top:-1.8100000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord">+</span><span class="mord mathit">a</span><span class="mord mathrm">/</span><span class="mopen">(</span><span class="mord">+</span><span class="mord mathrm">∞</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord">+</span><span class="mord mathrm">0</span></span></span></span><span style="top:-0.6100000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord">−</span><span class="mord mathit">a</span><span class="mord mathrm">/</span><span class="mopen">(</span><span class="mord">+</span><span class="mord mathrm">∞</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord">−</span><span class="mord mathrm">0</span></span></span></span><span style="top:0.5900000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord">+</span><span class="mord mathit">a</span><span class="mord mathrm">/</span><span class="mopen">(</span><span class="mord">−</span><span class="mord mathrm">∞</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord">−</span><span class="mord mathrm">0</span></span></span></span><span style="top:1.7900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord">−</span><span class="mord mathit">a</span><span class="mord mathrm">/</span><span class="mopen">(</span><span class="mord">−</span><span class="mord mathrm">∞</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord">+</span><span class="mord mathrm">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></p> <p>a是正数</p> <p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mtable><mtr><mtd><mrow><mrow><mi mathvariant="normal">∞</mi><mo>+</mo><mi mathvariant="normal">∞</mi><mo>=</mo><mo>+</mo><mi mathvariant="normal">∞</mi></mrow></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mi mathvariant="normal">∞</mi><mo>−</mo><mi mathvariant="normal">∞</mi><mo>=</mo><mi>N</mi><mi>a</mi><mi>N</mi></mrow></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mi mathvariant="normal">∞</mi><mo>×</mo><mi mathvariant="normal">∞</mi><mo>=</mo><mi mathvariant="normal">∞</mi></mrow></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mi mathvariant="normal">∞</mi><mi mathvariant="normal">/</mi><mi mathvariant="normal">∞</mi><mo>=</mo><mi>N</mi><mi>a</mi><mi>N</mi></mrow></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mi mathvariant="normal">∞</mi><mi mathvariant="normal">/</mi><mi>a</mi><mo>=</mo><mi>α</mi></mrow></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mi mathvariant="normal">∞</mi><mi mathvariant="normal">/</mi><mn>0</mn><mo>=</mo><mi mathvariant="normal">∞</mi></mrow></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mi mathvariant="normal">∞</mi><mi mathvariant="normal">/</mi><mn>0</mn><mo>=</mo><mi mathvariant="normal">∞</mi></mrow></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mn>0</mn><mi mathvariant="normal">/</mi><mn>0</mn><mo>=</mo><mi>N</mi><mi>a</mi><mi>N</mi></mrow></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">\left. \begin{array} { l } { \infty + \infty = + \infty } \\ { \infty - \infty = N a N } \\ { \infty \times \infty = \infty } \\ { \infty / \infty = N a N } \\ { \infty / a = \alpha } \\ { \infty / 0 = \infty } \\ { \infty / 0 = \infty } \\ { 0 / 0 = N a N } \end{array} \right.</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:5.05em;"></span><span class="strut bottom" style="height:9.6em;vertical-align:-4.55em;"></span><span class="base textstyle uncramped"><span class="minner textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist"><span style="top:-4.21em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">∞</span><span class="mbin">+</span><span class="mord mathrm">∞</span><span class="mrel">=</span><span class="mord">+</span><span class="mord mathrm">∞</span></span></span></span><span style="top:-3.0100000000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">∞</span><span class="mbin">−</span><span class="mord mathrm">∞</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-1.8100000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">∞</span><span class="mbin">×</span><span class="mord mathrm">∞</span><span class="mrel">=</span><span class="mord mathrm">∞</span></span></span></span><span style="top:-0.6100000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">∞</span><span class="mord mathrm">/</span><span class="mord mathrm">∞</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:0.5900000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">∞</span><span class="mord mathrm">/</span><span class="mord mathit">a</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.0037em;">α</span></span></span></span><span style="top:1.7900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">∞</span><span class="mord mathrm">/</span><span class="mord mathrm">0</span><span class="mrel">=</span><span class="mord mathrm">∞</span></span></span></span><span style="top:2.9900000000000007em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">∞</span><span class="mord mathrm">/</span><span class="mord mathrm">0</span><span class="mrel">=</span><span class="mord mathrm">∞</span></span></span></span><span style="top:4.1899999999999995em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">0</span><span class="mord mathrm">/</span><span class="mord mathrm">0</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></p> <p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mtable><mtr><mtd><mrow><mrow><mo>+</mo><mi>a</mi><mi mathvariant="normal">/</mi><mo>+</mo><mn>0</mn><mo>=</mo><mo>+</mo><mi mathvariant="normal">∞</mi></mrow></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mo>−</mo><mi>a</mi><mi mathvariant="normal">/</mi><mo>+</mo><mn>0</mn><mo>=</mo><mo>−</mo><mi mathvariant="normal">∞</mi></mrow></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">\left. \begin{array} { l } { + a / + 0 = + \infty } \\ { - a / + 0 = - \infty } \end{array} \right.</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="strut" style="height:1.45em;"></span><span class="strut bottom" style="height:2.4000000000000004em;vertical-align:-0.9500000000000004em;"></span><span class="base textstyle uncramped"><span class="minner textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord">+</span><span class="mord mathit">a</span><span class="mord mathrm">/</span><span class="mbin">+</span><span class="mord mathrm">0</span><span class="mrel">=</span><span class="mord">+</span><span class="mord mathrm">∞</span></span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord">−</span><span class="mord mathit">a</span><span class="mord mathrm">/</span><span class="mbin">+</span><span class="mord mathrm">0</span><span class="mrel">=</span><span class="mord">−</span><span class="mord mathrm">∞</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></p> <p>这些规定带来的好处是简化了代码，如</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>a <span class="token operator">=</span> f<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> then
	do something
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>当f(x)返回NaN和-\infin时，布尔表达式返回FALSE，而f(x)返回\infin时，返回TRUE。与期望结果相同，并且不需要额外的判断操作数为不为零等。</p> <h2 id="效率"><a href="#效率" class="header-anchor">#</a> 效率</h2> <p>只有通过认真的权衡(tradeoffs)才能获得效率的提升，并且对不同的体系结构会有不同的权衡。但是，当下，有一个不错的启发式，即程序员应该更加注意内存访问模式而不是操作的数量。这与二十年前恰好相反，原因是内存的访问速度跟不上处理器的处理速度。另外，现代CPU处理浮点运算的速度已经和处理整型运算的速度差不多了。</p> <p>一个合理地写出高效代码的流程：</p> <ol><li>尽可能写出最直截了当的代码。在运行时计算出中间结果而不要保存。</li> <li>使用优化模式编译。</li> <li>使用分析工具找出关键瓶颈。</li> <li>检查数据结构以找出提高局部性的方法。如果可能的话，让数据单元的大小和cache/page的大小相匹配。</li> <li>如果分析显示瓶颈在数值计算上，检查编译器生成的汇编代码来找出低效的原因。重写源代码来解决你找到的问题。</li></ol> <p>其中最重要的是第一步。大多数”优化“除了使代码更难阅读之外，并没有提升速度。此外，把时间花在优化代码上，通常比花在修复bug和添加特性上好。</p> <p>在所有场景中，分析工具都非常重要。</p> <h2 id="设计和编写图形程序"><a href="#设计和编写图形程序" class="header-anchor">#</a> 设计和编写图形程序</h2> <h3 id="类设计"><a href="#类设计" class="header-anchor">#</a> 类设计</h3> <p>任何图形程序的一个关键点为要有为几何实体(如向量和矩阵)和图形实体(如RGB颜色和图像)设计良好的类和惯例(routines)，并且尽可能简洁和高效。一个常见的问题是，是否要为位置(locations)和位移(displacement)分别设计一个类，因为它们有不同的操作，例如，位置乘以0.5没有几何意义，而位移有。目前这个问题尚且没有定论，这里假设不作区分。</p> <p>基本的类</p> <ul><li>vector2：一个2维向量类，有x和y两个数据成员，且存储在一个长度为2的数组中，以支持索引操作符。函数成员包括向量的加减，点积，叉积，标量乘除法。</li> <li>vector3：类似2维向量。</li> <li>hvector：有4个成员的齐次(homogeneous)向量。见第7章。</li> <li>rgb：有3个数据成员，函数成员包括RGB加减乘，标量乘除。</li> <li>transform：一个4x4的变换矩阵。需要有矩阵乘法和用于位置，方向和表面法向量的成员函数。见第6章。</li> <li>image： RGB 像素的2维数组，有一个输出操作。</li></ul> <h3 id="float-vs-double"><a href="#float-vs-double" class="header-anchor">#</a> Float vs. Double</h3> <p>从减少内存使用和保持一致的内存访问模式的角度来看，使用float会更高效。而为了减少数值问题，使用double会更好。这种权衡取决于具体程序。</p> <p>建议：几何计算使用double，颜色计算使用float。对占用许多内存的三角形网格(triangle mesh)用float存储，但在成员函数中使用时转换为double。</p> <p>一句话，能用float就用float，除非在某个部分float精度不够。</p> <h3 id="debug"><a href="#debug" class="header-anchor">#</a> Debug</h3> <p>经验丰富的程序员很少使用传统的dubugger。原因是对复杂的程序来说这样的的debugger不好用，另外，最难的错误是观念上的错误，即错误的东西被实现了，这种错误会浪费大量时间在一步步debug过程上。下面介绍一些图形学中经典的debugging策略。</p> <p><strong>The Scientific Method</strong></p> <p>如果图像出错了，先观察哪里出错了，然后找出一个假设，什么会引起这种问题并测试。例如，在写光线追踪程序时，有一种经典的错误—“shadow acne”(阴影痤疮，粉刺)。传统的debugger没用，我们必须意识到，阴影射线(shadow ray)击中了被着色物体的表面。我们可能注意到，黑色点的颜色是环境光照，以至于直接光照丢失了(被黑色覆盖了)。在阴影中，直接光照会关闭，所以你假设这些本不应该在阴影中的点被错误的标记成阴影了。为了测试这个假设，我们可以关闭阴影检查再重新编译。这可能会提示一个错误，但我们继续进行。这种方式可行的原因是，我们无需关注一个错误的值或真的发现我们的观念错误，只是通过实验一步步缩小观念误差的范围。</p> <p><strong>Images as Coded Debugging Output</strong></p> <p>在许多情况下，从图形程序中获取调试信息的最简单渠道就是输出图像本身。如果您想知道针对每个像素运行的部分计算的某些变量的值，可以修改暂时程序，直接将这些数据复制到输出图像中并跳过其余部分。例如，如果您怀疑表面法线问题导致着色问题，则可以将法线向量直接复制到图像（x变为红色，y变为绿色，z变为蓝色），从而产生计算中实际使用的向量的颜色编码图(color-coded illustration)。或者，如果您怀疑特定的值有时会超出其有效范围，在程序中让发生该事的像素染成红色。其他通用的技巧还有画出不可见的边，用物体的ID为图像着色，用像素花费的计算量为图像着色等等。</p> <p><strong>Using a Debugger</strong></p> <p><strong>Data Visualization for Debugging</strong></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/note/cg/ch8.html">
        第八章 图形管线(The Graphics Pipeline)
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.f6ce4901.js" defer></script><script src="/assets/js/2.f48cadb2.js" defer></script><script src="/assets/js/14.23a1db9c.js" defer></script>
  </body>
</html>
